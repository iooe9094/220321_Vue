<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document</title>
    <!-- Vue cdn -->
    <script src="https://cdn.jsdelivr.net/npm/vue/dist/vue.js"></script>
    <!-- lodash cdn -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/lodash.js/4.17.15/lodash.min.js"></script>
    <link rel="stylesheet" href="../220316_Vue/count_up_down.css">
</head>

<body>
    <h2>JSON 파일 읽어들여 트랜지션 효과를 주는 예제</h2>
    <div id="app">
        <transition-group>
            <div v-for="item in dataArray" :key="item.title">
                <my-product :object="item"></my-product>
            </div>
        </transition-group>

        <button @click="sortData">정렬</button>
        <button @click="shuffleData">셔플</button>
        <input type="file" @change="onFileChange">
    </div>

    <script>
        // 자식 컴포넌트 객체 정의
        let Mycomponent = {
            props: ["object"],
            template: /* html */
                `<div style="width:300px; backgroundColor:#ffddaa;">
                    <p style="backgroundColor:#ffa95e">{{ object.title }}</p>
                    <p> 해설 : {{ object.body }} </p>
                </div>`,
        };

        new Vue({
            el: "#app",
            data() {
                return {
                    dataArray: [
                        { title: "AAA", body: "aaa" },
                        { title: "BBB", body: "bbb" },
                        { title: "CCC", body: "ccc" }
                    ]
                }
            },
            components: {
                "my-product": Mycomponent
            },
            methods: {
                sortData: function () {
                    // lodash의 orderBy 함수 사용하기
                    // 첫 번째 매개변수 : 객체배열
                    // 두 번째 매개변수 : 정렬하고싶은 객체의 속성
                    // 세 번째 매개변수 : 오름차순("asc"), 내림차순(desc)
                    // return : 새로 정렬된 객체 배열
                    this.dataArray = _.orderBy(this.dataArray, "title", "asc")
                },
                shuffleData: function () {
                    // lodash 셔플함수 : shuffle
                    // 첫 번째 매개변수 : 객체배열
                    // return : 새로 셔플된 객체 배열
                    this.dataArray = _.shuffle(this.dataArray)
                },
                onFileChange: function (event) {
                    let file = event.target.files[0];
                    if(file) {
                        let reader = new FileReader();
                        let vm = this;

                        reader.readAsText(file);

                        reader.onload = function(event) {
                            vm.dataArray = JSON.parse(event.target.result);
                        }
                    }
                }
            }

        });
    </script>
</body>

</html>